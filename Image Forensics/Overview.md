#  图像取证：来源认证和篡改识别 (简要笔记)

>  [Image Forensics: Source Identification and Tampering Detection](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.471.9052&rep=rep1&type=pdf)
>
>  Universita degli Studi di Firenze

## Chapter 1 图像取证简介

用科学手段获取犯罪证据叫做取证科学。可以根据证据领域不同将取证科学分为几个子类。经典(模拟)的取证方式对应物理证据，电子证据对应电子取证。

>  科技的使用赋予并且证明了以建立或拓展证据机制为目的，保存、收集、校验、识别、分析、翻译、归档和展示从电子资源获取的电子证据的方式，以及帮助预知未授权的行动是十分有效的。

电子取证科学可以分为几个子分支：电脑取证，网络取证，数据库取证，移动设备取证和多媒体取证。

多媒体取证解决现实的电子展示，比如图像，视频，音频文件的真实性判断。

## Chapter 2 多媒体取证

多媒体取证的基本观点是对多媒体的获取和任何后置处理都会在数据中留下唯一的痕迹，就像一系列的电子指纹一样。分析这些指纹可以得到图像/视频的来源，数字内容真伪等有用信息。这一章解决两个问题。1）电子内容的来源是什么？ 2）电子内容是真是假？

### 2.1 多媒体取证： 原则和动机

#### 2.1.1 可行方法

我们需要保护电子图片(视频)，校验其真伪，更甚至追踪其来源，解决方法通常是在原始数据中插入一个嵌入式的信息。这种技术被归类为*电子水印*。首先需要约定一个私有Key`K`。对于目标文档`I`, 对其进行轻微修改，加上水印`W`,即可输出带水印图片`IW`。如果需要评估带水印的图片是否有经过处理，需要运用私有Key`K`，将待分析图片的水印重新提取出来，或者对比校验参数。

如果图片是完整的，我们也可以对图片进行加密操作。用电子签名校验作者，签名时间和真实信息内容。通过用哈希算法对电子数据进行整理，用私有Key对齐加密计算就可以得到电子签名。但是电子签名有几个缺点：第一、电子签名必须要和内容整合在一起。第二，任何对图片的修改都会导致电子签名不同，这样就无法区分恶意修改和无意修改。最后，加密技术一般不能精确定位篡改。

#### 2.1.2 电子证据的类型和特点

电子取证处理的大多数电子数据是图片：一个三通道的二维数组（如果是灰度图片，只有一维）。首先，如果图片是由数码相机拍摄的真实场景，最终存储的图片会因为取样传感器，处理单元的不同而天生带有不完美和可变性。并且，在到达传感器之前，`CFA(Color Filter Array)`会过滤场景的光线，让每个像素只有一种特定的颜色。传感器输出会持续插值，获取每个像素的所有三原色。这个信号会经过额外处理，比如白平衡，伽马校准，图像增强等处理。然后才会以自定义格式存储到相机中，一般是`JPEG`格式。

目前已经有技术可以根据图像材质识别特定的`CFA`，找到相机品牌[9]。也有方法研究`JPEG`的量化因子来校验一个图像是否经过二次压缩，以判断是否经过篡改[10]。另外，也有一些研究由于设备造成的图片上的异常点(anomalies)，比如镜头刮痕，有缺陷的像素[20]等。还有研究关注传感器噪声,暗电流(dark current)，拍摄噪声，热噪声等。照片响应不一致性(PRNU, Photo Response Non-Uniformity)是图像取证应用中常用手段。这种噪声是一种天然的系统指纹，可以用于识别单个传感器。也就是说同一品牌型号的两个相机会留下不一样的痕迹。所以PRNU并不是一种随机噪声。

识别计算机生成图片的基本思想是抽取主要特征，查找对应的现实场景。。。。

#### 2.1.3 应用场景

我们可以将场景分成两类，"来源识别"和“伪造检测”。

“来源识别”是在取证过程中找到数字图像的原始来源。又可以分为2个子类，第一是识别产出电子内容的设备。第二是识别电脑生成的图片。比较主流的处理是基于`SVM(Support Vector Machine)`或者噪声特征校准技术。

"伪造检测"鉴别一个图片是真实的，或者是人为修改过内容的。这种分析的主要障碍是被修改部分的尺寸对于整个图片大小的比例。但是相反的，也不能低估对图片一个细微的修改可以导致整个图片内容的重大改动。这种几个像素的修改不是一直能获取到的。

#### 2.1.4 天然的电子指纹

电子取证基于这样一种思想：在电子内容在创造和后续的所有处理中都会留下内在的痕迹(比如电子指纹)[15]。考虑以下三类电子指纹：

1. 相机内置指纹：电子获取设备的每个组件都会修改输入，在最终输出中留下指纹。
2. 相机外置指纹：相机的处理器都会留下特定指纹。
3. 场景指纹：照片取景根据内容不同会有特定属性，比如光照属性。

选择特定指纹后，选择一些属性，查找相关参数，可以用分类方法或评估过程来做判定。对于来源识别，可以抽取痕迹，对比各个品牌，型号的可能的指纹数据集来做关联。对于伪造检测，可以甄别指纹的不一致性或阻断。

### 2.2 获取设备身份的技术

主要研究的是两个方面的信息：什么设备产生了这些电子数据，以及进一步找出什么特定的品牌，型号的相机产生了这样的内容。

目前有很多种格式的电子图片，比如`JPEG`, `GIF`, `PNG`, `TIFF`,这些格式本身就能提供很多有用信息。比如`JPEG`图片本身就有良好定义的元数据特征集，图片压缩的量化表和损耗压缩数据。元数据描述了图片来源，一般包括相机类型，分辨率，焦点设定和其他特征[16]。除了这些原生格式，相机本身会创建一个头文件，记录所有相机设置，包括锐化等级，对比度和饱和度设置，色温/白平衡等。但是这些元数据能编辑，删除和插入错误信息。

#### 2.2.1 CFA和去马赛克

单成像传感器的数码相机最常见的CFA是`BayerCFA`。由于CFA只让每个像素有一种颜色，所以相机必须评估遗漏的另外两种颜色值。这种评估过程叫去`马赛克(demosaicking)`。

有许多种常用的颜色插值算法。给定一个输出图像`I`，获取设备身份的技术是聚焦在颜色过滤数据特征和颜色插值算法。一种方法[9]假设数码相机用RGB类型的CFA，有$2\times2$ 的规律。因此图片`I`在CFA取样后变成：
$$
I_s=
\begin{cases}
I(x, y,c)& \text{if t(x,y)=c}\\
0& \text{otherwise}
\end{cases}
$$
其中$t(x,y)$是CFA特征，$c$可能是R, G和B。$I_s(x, y,c)=0$的中间像素，用相邻像素的值进行插值。颜色插值因子和CFA可以用于识别相机品牌。因此训练`SVM`分类器，识别颜色插值方法，是识别不同相机的好方法。

就如之前所说，在一个CFA插值颜色图像中的每个像素位置，相机传感器捕获单色样本，另外两种颜色是从邻近像素估算出的。在一个颜色通道里，样本的子集是根据邻近样本校准的。这种校准可以用如下线性模型表示：
$$
f(x, y) = \sum_{u, v=-N}^N a_{u,v}f(x+u, y+v)
$$
其中$a_{u,v}$是模型参数因子，$N$是需校准的像素数。

从`EM(Expectation Maximization)`算法中获取的数据可以用于判断一个彩色图片是否是一个CFA插值算法和线性因子的结果。`EM`算法会返回$a_{u,v}$，用于区分不同的CFA插值技术[17,18]

这种方法不能用于相同型号的相机，因为它们的CFA过滤和插值算法是相同的，也不适用于压缩图片和修改过的图片（伽马校准，平滑处理），因为这些修改会去除CFA插值的效果。

#### 2.2.2 不完美的成像传感器

有多种缺陷和噪声的来源会影响图像获取处理[19]。这些问题包括传感器的像素缺陷和模式噪声，也就是固定模式噪声（FPN, fixed pattern noise）和照片响应不一致性(PRNU)。

FPN是指当传感器阵列没有曝光（暗电流）下像素间的差异，也取决于温度等。FPN在[21]中用于源相机的识别。

PRNU是模式噪声的主要部分。其最重要的组成部分是像素不一致性(PNU, pixel non-uniformity)，由像素对光感性的区别决定，是传感器的天然特征（指纹）。

图像获取过程中传感器$l$的数字输出可以用以下数学模型表示：
$$
l=k(s+p)+r+d
$$
其中$s$是无其他噪声源存在时的信号，$p$是随机的散粒噪声(shot noise)，$r$是附加的随机噪声，$d$是暗电流。因子$k$捕获PRNU噪声，接近于1，是一种乘性噪声(multiplicative noise)。由于处理过程的细节不是很好获取，一般用简化模型。[22]用以下向量形式描述了这种简化的传感器输出模型：
$$
l=\sigma^\gamma \cdot[(1+\Gamma)\Upsilon+\Pi]^\gamma+\theta_q
$$
其中$\Upsilon$是传感器的折射光强度，$\sigma$是颜色通道值，$\gamma$是伽马校准因子（一般是0.45）。数乘因子$\Gamma$是零平均类噪声信号，$\Pi$是其他噪声来源的组合，包括暗电流，散粒噪声，读出噪声，$\theta_q$是量化噪声。

[24]介绍了一种识别合成图片和相机拍摄图片的方法。这种方法基于电脑生成的图片一般会缺少传感器的模式噪声。

[14, 25]介绍了一种基于PRNU评估的技术，用于分类扫描和非扫描的图片。